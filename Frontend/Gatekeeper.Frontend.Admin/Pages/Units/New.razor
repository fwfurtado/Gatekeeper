@page "/units/new"
@using Gatekeeper.Frontend.Admin.Dtos

@inject HttpClient Http
@inject ISnackbar Snackbar
@inject NavigationManager NavigationManager


<PageTitle>Unit</PageTitle>


<MudText Typo="Typo.h2">New Unit</MudText>
<MudPaper Class="pa-4">
    <MudForm>
        <MudTextField T="string" @bind-value="Identifier" Text="@Identifier" Label="Identifier" Required="true" RequiredError="Identifier is required!"/>
        <MudButton Color="Color.Primary" OnClick="async () => await SaveUnit()">Save</MudButton>
    </MudForm>
</MudPaper>


@code {


    public string Identifier { get; set; } = string.Empty;


    private async Task SaveUnit()
    {
        var response = await Http.PostAsJsonAsync("/units", new UnitRequest() { Identifier = Identifier });

        if (response.IsSuccessStatusCode)
        {
            Snackbar.Add("Unit saved", Severity.Success);
            NavigationManager.NavigateTo("/units");
        }
        else
        {
            Snackbar.Add("Error saving unit", Severity.Error);
        }
        
    }

}